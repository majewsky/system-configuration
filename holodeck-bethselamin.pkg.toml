[package]
name        = "holodeck-bethselamin"
version     = "1.27.0"
description = "holodeck: services on Bethselamin"

requires = [
    "secrets", # this uses /usr/bin/replicator
    "hologram-base-hetzner",
    "hologram-automation",
    "hologram-ferm",
    "hologram-monitoring-server",
    "hologram-consul",
    "linux-headers", # for wireguard-dkms
    "grub",
]

################################################################################
# identity

[[file]]
path    = "/etc/hostname"
content = "bethselamin"

[[file]]
path    = "/etc/profile.d/prettyprompt.sh"
content = """
    export PRETTYPROMPT_COMMONUSER=stefan
    export PRETTYPROMPT_HOSTCOLOR='0;31'
"""

################################################################################
# network interface configuration as generated by Hetzner's installimage

[[file]]
path    = "/etc/systemd/network/50-hetzner.network"
content = """
    [Match]
    MACAddress={{.Vars.bethselamin.mac_address}}

    [Network]
    Address={{.Vars.bethselamin.ipv6_address}}/64
    Gateway=fe80::1

    Address=172.31.1.100/24
    Gateway=172.31.1.1
"""
[[symlink]]
path   = "/usr/share/holo/files/50-bethselamin-vars/etc/systemd/network/50-hetzner.network.holoscript"
target = "/usr/bin/replicator"
