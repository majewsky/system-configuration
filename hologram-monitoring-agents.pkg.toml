[package]
name        = "hologram-monitoring-agents"
version     = "0.1.0"
description = "hologram: monitoring agents"

requires = [
  "prometheus-node-exporter",
]

# allow Prometheus access to exporters via private network
[[file]]
path    = "/etc/ferm.d/incoming-exporters"
content = "proto tcp dport 9100 interface wg-monitoring ACCEPT;"
[[symlink]]
path   = "/usr/share/holo/files/20-monitoring-server/etc/ferm.d/incoming-exporters.holoscript"
target = "/usr/bin/replicator"

################################################################################
# node exporter

[[symlink]]
path = "/etc/systemd/system/multi-user.target.wants/prometheus-node-exporter.service"
target = "/usr/lib/systemd/system/prometheus-node-exporter.service"

[[file]]
path = "/etc/systemd/system/prometheus-node-exporter.service.d/hardening.conf"
content = '''
  [Service]
  User=nobody
  Group=nobody
'''
